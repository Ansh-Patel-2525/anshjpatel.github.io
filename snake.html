<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Snake - Ansh Patel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <header class="game-header">
    <div class="game-header-content">
      <h1>üêç Snake</h1>
      <div class="header-links">
        <a href="widgets.html" class="back-link">‚Üê Back to Widgets</a>
        <a href="index.html" class="back-link">üè† Home</a>
      </div>
    </div>
  </header>

  <main class="game-container">
    <div class="game-card">
      <div class="game-info">
        <span>
          Score:
          <strong id="snakeScore">0</strong>
        </span>
        <span>
          High Score:
          <strong id="snakeHighScore">0</strong>
        </span>
      </div>

      <canvas id="snakeCanvas" width="300" height="300"></canvas>

      <p id="snakeStatus" class="game-status">Press Start to Play</p>

      <button onclick="startSnake()" class="widget-btn">
        Start Game
      </button>

      <p class="game-instruction">
        Use Arrow Keys to move
      </p>
    </div>
  </main>

  <script>
    // Prevent arrow keys from scrolling the page
    window.addEventListener(
      "keydown",
      function (e) {
        if (
          ["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight"].indexOf(e.code) > -1
        ) {
          e.preventDefault();
        }
      },
      false
    );

    let snakeGame = {
      canvas: document.getElementById("snakeCanvas"),
      ctx: document
        .getElementById("snakeCanvas")
        .getContext("2d"),
      snake: [{ x: 150, y: 150 }],
      direction: { x: 0, y: 0 },
      food: { x: 0, y: 0 },
      score: 0,
      highScore: parseInt(
        localStorage.getItem("snakeHighScore") || "0"
      ),
      gameLoop: null,
      gridSize: 15,
      running: false
    };

    document.getElementById("snakeHighScore").textContent =
      snakeGame.highScore;

    document.addEventListener("keydown", (e) => {
      if (!snakeGame.running) return;

      if (e.key === "ArrowUp" && snakeGame.direction.y === 0) {
        snakeGame.direction = {
          x: 0,
          y: -snakeGame.gridSize
        };
      } else if (
        e.key === "ArrowDown" &&
        snakeGame.direction.y === 0
      ) {
        snakeGame.direction = {
          x: 0,
          y: snakeGame.gridSize
        };
      } else if (
        e.key === "ArrowLeft" &&
        snakeGame.direction.x === 0
      ) {
        snakeGame.direction = {
          x: -snakeGame.gridSize,
          y: 0
        };
      } else if (
        e.key === "ArrowRight" &&
        snakeGame.direction.x === 0
      ) {
        snakeGame.direction = {
          x: snakeGame.gridSize,
          y: 0
        };
      }
    });

    function startSnake() {
      if (snakeGame.running) return;

      snakeGame.snake = [{ x: 150, y: 150 }];
      snakeGame.direction = {
        x: snakeGame.gridSize,
        y: 0
      };
      snakeGame.score = 0;
      snakeGame.running = true;

      document.getElementById("snakeScore").textContent = "0";
      document.getElementById("snakeStatus").textContent =
        "Playing...";

      placeFood();

      snakeGame.gameLoop = setInterval(() => {
        updateSnake();
        drawSnake();
      }, 100);
    }

    function updateSnake() {
      const head = {
        x: snakeGame.snake[0].x + snakeGame.direction.x,
        y: snakeGame.snake[0].y + snakeGame.direction.y
      };

      if (
        head.x < 0 ||
        head.x >= 300 ||
        head.y < 0 ||
        head.y >= 300
      ) {
        gameOver();
        return;
      }

      if (
        snakeGame.snake.some(
          (segment) =>
            segment.x === head.x &&
            segment.y === head.y
        )
      ) {
        gameOver();
        return;
      }

      snakeGame.snake.unshift(head);

      if (
        head.x === snakeGame.food.x &&
        head.y === snakeGame.food.y
      ) {
        snakeGame.score += 10;
        document.getElementById("snakeScore").textContent =
          snakeGame.score;
        placeFood();
      } else {
        snakeGame.snake.pop();
      }
    }

    function drawSnake() {
      snakeGame.ctx.fillStyle = "#000";
      snakeGame.ctx.fillRect(0, 0, 300, 300);

      snakeGame.snake.forEach((segment, index) => {
        snakeGame.ctx.fillStyle =
          index === 0 ? "#059669" : "#10b981";

        snakeGame.ctx.fillRect(
          segment.x,
          segment.y,
          snakeGame.gridSize - 2,
          snakeGame.gridSize - 2
        );
      });

      snakeGame.ctx.fillStyle = "#ef4444";
      snakeGame.ctx.fillRect(
        snakeGame.food.x,
        snakeGame.food.y,
        snakeGame.gridSize - 2,
        snakeGame.gridSize - 2
      );
    }

    function placeFood() {
      snakeGame.food = {
        x: Math.floor(Math.random() * 20) * snakeGame.gridSize,
        y: Math.floor(Math.random() * 20) * snakeGame.gridSize
      };

      if (
        snakeGame.snake.some(
          (segment) =>
            segment.x === snakeGame.food.x &&
            segment.y === snakeGame.food.y
        )
      ) {
        placeFood();
      }
    }

    function gameOver() {
      clearInterval(snakeGame.gameLoop);
      snakeGame.running = false;

      if (snakeGame.score > snakeGame.highScore) {
        snakeGame.highScore = snakeGame.score;
        localStorage.setItem(
          "snakeHighScore",
          snakeGame.highScore
        );
        document.getElementById("snakeHighScore").textContent =
          snakeGame.highScore;
      }

      document.getElementById(
        "snakeStatus"
      ).textContent = `Game Over! Final Score: ${snakeGame.score}`;
    }
  </script>
</body>
</html>
